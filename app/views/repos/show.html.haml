= render 'title', title: t('.title', repo_name: @repo.name.capitalize)

= render 'form',
    form_path: repo_path(organization_name: @repo.organization.name, repo_name: @repo.name)

.col-xs-8
  - if !@chart_columns || @chart_columns.empty?
    .alert.alert-warning
      .l-align-center
        = t('.select_benchmark')

  - else
    - @chart_columns.each_with_index do |columns, index|
      - benchmark_name = columns[3].humanize

      %h2.l-align-center
        = t('.graph_title', graph_name: benchmark_name)

      #chart{ id: "#{index}" }

      - if script_url = columns[2]
        %h2.l-align-center
          = t('.script_title', graph_name: benchmark_name)

        = Pygments.highlight("#{Net::HTTP.get(URI.parse(script_url))}",
            lexer: :ruby, options: { linenos: 'inline' }).html_safe

      %hr

      - content_for(:footer) do
        :javascript
          $(function () {
            $("#chart_#{index}").highcharts({
              chart: {
                zoomType: 'x'
              },
              subtitle: {
                text: document.ontouchstart === undefined ? 'Click and drag in the plot area to zoom in' : 'Pinch the chart to zoom in'
              },
              title: {
                text: ""
              },
              exporting: {
                enabled: false
              },
              tooltip: {
                useHTML: true,
                crosshairs: true,
                shared: true
              },
              xAxis: {
                categories: #{columns[0]},
                labels: {
                  enabled: false
                },
                title: {
                  text: "Commits displayed in ascending order based on the commit date",
                  margin: 10
                }
              },
              yAxis: {
                title: {
                  text: "#{columns[1].capitalize}",
                },
                type: 'logarithmic'
              },
              legend: {
                layout: 'vertical',
                align: 'center',
                verticalAlign: 'bottom',
                borderWidth: 0
              },
              series: [
                {
                  name: "#{columns[3]}",
                  data: #{columns[4]}
                }
              ]
            });
          });
